# Robot Graph Configuration
# Defines the complete robot system topology and node connections

robot:
  # System components
  system_monitor:
    enabled: true
    package: system_monitor
    node: system_monitor_node
    namespace: /system
    parameters:
      update_rate: 1.0
      temp_warning_threshold: 70.0
      temp_critical_threshold: 85.0
      cpu_warning_threshold: 80.0
      memory_warning_threshold: 85.0
      disk_warning_threshold: 85.0
    topics:
      publish:
        - /system/status
        - /system/temperature/cpu
        - /system/temperature/gpu
        - /system/cpu/usage
        - /system/memory/usage
        - /system/disk/usage
        - /system/power
        - /system/alerts
        - /system/camera/health
      subscribe:
        - /realsense/status

  # VLA Controller (placeholder for future)
  vla_controller:
    enabled: false
    package: vla_controller
    node: vla_controller_node
    namespace: /control
    parameters:
      model_path: ""
      update_rate: 10.0
    topics:
      publish:
        - /control/commands
        - /control/status
      subscribe:
        - /camera/image
        - /system/status

  # RealSense Cameras
  realsense_camera:
    enabled: true
    package: realsense_camera
    node: realsense_camera_node
    namespace: /hardware
    parameters:
      enable_color: true
      enable_depth: true
      enable_pointcloud: true
      color_width: 640
      color_height: 480
      color_fps: 30
      depth_width: 640
      depth_height: 480
      depth_fps: 30
      publish_rate: 30.0
    topics:
      publish:
        - /camera_front/color/image_raw
        - /camera_front/color/camera_info
        - /camera_front/depth/image_rect_raw
        - /camera_front/depth/camera_info
        - /camera_rear/color/image_raw
        - /camera_rear/color/camera_info
        - /camera_rear/depth/image_rect_raw
        - /camera_rear/depth/camera_info
        - /camera_front/points
        - /camera_rear/points
        - /realsense/status
      subscribe: []

  # USB Microphone
  usb_microphone:
    enabled: true
    package: usb_microphone
    node: usb_microphone_node
    namespace: /hardware
    parameters:
      device: 'default'
      sample_rate: 16000
      channels: 1
      format: 'S16_LE'
      chunk_size: 1024
      publish_rate: 10.0
    topics:
      publish:
        - /microphone/status
      subscribe: []

  # ODrive Motor Controller
  odrive_controller:
    enabled: true
    package: odrive_controller
    node: odrive_controller_node
    namespace: /hardware
    parameters:
      serial_port: '/dev/ttyUSB0'
      baudrate: 115200
      timeout: 1.0
      use_can: false
      can_interface: 'can0'
      can_node_id: 0
      publish_rate: 50.0
      enable_accelerometer: true
    topics:
      publish:
        - /odrive/status
        - /odrive/imu
      subscribe:
        - /cmd_vel

  # iRobot Developer Kit Serial
  irobot_serial:
    enabled: true
    package: irobot_serial
    node: irobot_serial_node
    namespace: /hardware
    parameters:
      serial_port: '/dev/ttyUSB1'
      baudrate: 115200
      timeout: 1.0
      publish_rate: 10.0
      robot_type: 'create2'
    topics:
      publish:
        - /irobot/status
        - /irobot/battery
      subscribe:
        - /cmd_vel

  # PHAT Motor Controller (GPIO + Accelerometer)
  phat_motor_controller:
    enabled: true
    package: phat_motor_controller
    node: phat_motor_controller_node
    namespace: /hardware
    parameters:
      i2c_bus: 1
      accelerometer_address: 0x68
      accelerometer_type: 'MPU6050'
      enable_accelerometer: true
      publish_rate: 50.0
      motor_left_pwm_pin: 18
      motor_left_dir_pin: 16
      motor_right_pwm_pin: 19
      motor_right_dir_pin: 20
      pwm_frequency: 1000
    topics:
      publish:
        - /phat/status
        - /phat/imu
      subscribe:
        - /cmd_vel

  # Communication with sub-modules (placeholder)
  submodules:
    raspberry_pi:
      enabled: false
      namespace: /submodules/rpi
      topics:
        publish:
          - /submodules/rpi/status
        subscribe:
          - /submodules/rpi/commands

# Topic remappings
remappings:
  # Example remappings for different robot configurations
  # - from: /camera/image
  #   to: /front_camera/image

# Node groups
groups:
  core:
    - system_monitor

  control:
    - vla_controller

  hardware:
    - realsense_camera
    - usb_microphone
    - odrive_controller
    - irobot_serial
    - phat_motor_controller

  bench_test:
    - system_monitor
    - realsense_camera
    - usb_microphone
    - odrive_controller
    - irobot_serial
    - phat_motor_controller

  all:
    - system_monitor
    - vla_controller
    - realsense_camera
    - usb_microphone
    - odrive_controller
    - irobot_serial
    - phat_motor_controller
